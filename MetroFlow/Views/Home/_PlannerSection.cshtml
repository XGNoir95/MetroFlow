<!-- PLANNER SECTION (Two equal columns with equal heights) -->
<section id="plan" class="bg-white py-16">
    <div class="max-w-8xl lg:mx-40 px-6 md:mx-auto sm:mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 lg:items-stretch">
            <!-- LEFT: Interactive Map (Equal Height Container) -->
            <div class="flex flex-col">
                <h2 class="text-5xl font-bold text-green-700 mb-6">Interactive Metro Map</h2>
                <!-- Subheader directly under heading -->
                <p class="text-gray-600 text-xl font mb-8">
                    Zoom and drag on the map to explore stations and lines. Use the controls to zoom in/out or reset the
                    view.
                </p>
                <div class="rounded-2xl bg-white ring-1 ring-black/10 shadow-lg p-3 md:p-4 flex-1 flex flex-col">
                    <!-- Zoom/Pan canvas -->
                    <div id="map-wrapper"
                         class="relative flex-1 overflow-hidden rounded-xl bg-neutral-50 select-none"
                         style="min-height: 400px;">
                        <!-- The map image we'll transform -->
                        <img id="metro-map" src="metro-map.png" alt="Interactive metro map"
                             class="absolute left-0 top-0 h-full w-full object-contain will-change-transform transform-gpu pointer-events-none"
                             draggable="false">
                        <!-- Invisible overlay to capture interaction -->
                        <div id="map-overlay"
                             class="absolute inset-0 cursor-grab active:cursor-grabbing"
                             role="img"
                             aria-label="Drag to pan, scroll to zoom. Use plus and minus buttons to zoom.">
                        </div>
                    </div>
                    <!-- Controls -->
                    <div class="mt-4 flex items-center justify-between gap-3">
                        <div class="inline-flex items-stretch overflow-hidden rounded-xl ring-1 ring-black/10 shadow-sm">
                            <button id="zoom-out" type="button"
                                    class="px-4 py-3 text-base font-semibold hover:bg-neutral-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600"
                                    aria-label="Zoom out">
                                −
                            </button>
                            <div id="zoom-indicator"
                                 class="px-4 py-3 text-base border-x border-black/10 bg-white"
                                 aria-live="polite">
                                100%
                            </div>
                            <button id="zoom-in" type="button"
                                    class="px-4 py-3 text-base font-semibold hover:bg-neutral-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600"
                                    aria-label="Zoom in">
                                +
                            </button>
                            <button id="zoom-reset" type="button"
                                    class="px-4 py-3 text-base font-semibold hover:bg-neutral-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600"
                                    aria-label="Reset zoom">
                                Reset
                            </button>
                        </div>
                        <a href="metro-map.png" download
                           class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-900 to-green-600 px-5 py-3 text-base font-semibold text-white shadow-md hover:opacity-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2">
                            Download map
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 3a1 1 0 0 1 1 1v9.59l2.3-2.3a1 1 0 1 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-4-4A1 1 0 0 1 8.7 11.3L11 13.59V4a1 1 0 0 1 1-1Zm-7 14a1 1 0 1 1 0-2h14a1 1 0 1 1 0 2H5Z" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <!-- RIGHT: Tools Cards (Equal Height Container) -->
            <div class="flex flex-col">
                <!-- Match left heading color -->
                <h3 class="text-5xl font-bold text-green-700 mb-3">Plan your journey</h3>
                <p class="mt-3 text-lg text-gray-600 mb-8">
                    Zoom and drag on the map to explore stations and lines. Use the tools below for fares, tickets, and guides.
                </p>
                <!-- Clickable cards: icon left, title, subheading, no dropdowns -->
                <div class="space-y-4 flex-1">
                    <!-- Card: National Common Mobility Card - Updated to open modal -->
                    <button onclick="showRapidPassModal()" class="group block rounded-2xl ring-1 ring-black/10 bg-white min-h-[7rem] px-7 py-6 shadow-sm hover:bg-green-50 hover:ring-green-200 transition-shadow transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600 w-full text-left">
                        <div class="flex items-center gap-5">
                            <div class="shrink-0">
                                <svg class="h-9 w-9 text-green-700" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M4 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v7a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V5Zm4 14a1 1 0 1 1 0-2h8a1 1 0 1 1 0 2H8Z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-xl font-semibold text-gray-900">National Common Mobility Card</div>
                                <div class="mt-1 text-base text-gray-600">
                                    One card for seamless payments across transit systems.
                                </div>
                            </div>
                            <svg class="h-6 w-6 opacity-60 group-hover:opacity-100 transition" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M13 5a1 1 0 0 1 1.7-.7l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 1 1-1.4-1.4L17.59 13H4a1 1 0 1 1 0-2h13.59L13.3 6.7A1 1 0 0 1 13 5Z" />
                            </svg>
                        </div>
                    </button>

                    <!-- Card: Fare Calculator - Updated to open modal -->
                    <button onclick="showFareCalculatorModal()" class="group block rounded-2xl ring-1 ring-black/10 bg-white min-h-[7rem] px-7 py-6 shadow-sm hover:bg-green-50 hover:ring-green-200 transition-shadow transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600 w-full text-left">
                        <div class="flex items-center gap-5">
                            <div class="shrink-0">
                                <svg class="h-9 w-9 text-green-700" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M4 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v4H4V5Zm0 6h16v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-4Z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-xl font-semibold text-gray-900">Fare Calculator</div>
                                <div class="mt-1 text-base text-gray-600">
                                    Quickly estimate costs between any two stations.
                                </div>
                            </div>
                            <svg class="h-6 w-6 opacity-60 group-hover:opacity-100 transition" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M13 5a1 1 0 0 1 1.7-.7l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 1 1-1.4-1.4L17.59 13H4a1 1 0 1 1 0-2h13.59L13.3 6.7A1 1 0 0 1 13 5Z" />
                            </svg>
                        </div>
                    </button>

                    <!-- Card: Tickets - Updated to open modal -->
                    <button onclick="showTicketsModal()" class="group block rounded-2xl ring-1 ring-black/10 bg-white min-h-[7rem] px-7 py-6 shadow-sm hover:bg-green-50 hover:ring-green-200 transition-shadow transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600 w-full text-left">
                        <div class="flex items-center gap-5">
                            <div class="shrink-0">
                                <svg class="h-9 w-9 text-green-700" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M3 6a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v6H3V6Zm0 8h18v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4Z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-xl font-semibold text-gray-900">Tickets</div>
                                <div class="mt-1 text-base text-gray-600">
                                    Buy single rides or passes online or at stations.
                                </div>
                            </div>
                            <svg class="h-6 w-6 opacity-60 group-hover:opacity-100 transition" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M13 5a1 1 0 0 1 1.7-.7l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 1 1-1.4-1.4L17.59 13H4a1 1 0 1 1 0-2h13.59L13.3 6.7A1 1 0 0 1 13 5Z" />
                            </svg>
                        </div>
                    </button>

                    <!-- Card: Tour Guide -->
                    <a href="@Url.Action("Index", "Schedule")" data-route="tour-guide" class="group block rounded-2xl ring-1 ring-black/10 bg-white min-h-[7rem] px-7 py-6 shadow-sm hover:bg-green-50 hover:ring-green-200 transition-shadow transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600">
                        <div class="flex items-center gap-5">
                            <div class="shrink-0">
                                <svg class="h-9 w-9 text-green-700" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M12 3a9 9 0 1 1 0 18A9 9 0 0 1 12 3Zm1 5h-2v6h5v-2h-3V8Z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-xl font-semibold text-gray-900">Schedules</div>
                                <div class="mt-1 text-base text-gray-600">
                                    Find out the schedules of your nearest metro station.
                                </div>
                            </div>
                            <svg class="h-6 w-6 opacity-60 group-hover:opacity-100 transition" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M13 5a1 1 0 0 1 1.7-.7l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 1 1-1.4-1.4L17.59 13H4a1 1 0 1 1 0-2h13.59L13.3 6.7A1 1 0 0 1 13 5Z" />
                            </svg>
                        </div>
                    </a>

                    <!-- Card: Metro Museum -->
                    <a asp-controller="TouristSpots" asp-action="TouristAttractions" class="group block rounded-2xl ring-1 ring-black/10 bg-white min-h-[7rem] px-7 py-6 shadow-sm hover:bg-green-50 hover:ring-green-200 transition-shadow transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-600">
                        <div class="flex items-center gap-5">
                            <div class="shrink-0">
                                <svg class="h-9 w-9 text-green-700" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M2 20h20v2H2v-2zm1-3h18v2H3v-2z" />
                                    <path d="M5 17V8l7-6 7 6v9H5zm2-2h10V9.5L12 5.5 7 9.5V15z" />
                                    <path d="M9 10h2v5H9v-5zm4 0h2v5h-2v-5z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-xl font-semibold text-gray-900">Tourist Attractions</div>
                                <div class="mt-1 text-base text-gray-600">
                                    Explore the history and attractions within the country.
                                </div>
                            </div>
                            <svg class="h-6 w-6 opacity-60 group-hover:opacity-100 transition" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M13 5a1 1 0 0 1 1.7-.7l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 1 1-1.4-1.4L17.59 13H4a1 1 0 1 1 0-2h13.59L13.3 6.7A1 1 0 0 1 13 5Z" />
                            </svg>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- RAPID PASS NATIONAL COMMON MOBILITY CARD MODAL -->
<div id="rapidPassModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-white rounded-[24px] w-full max-w-4xl max-h-[90vh] shadow-2xl overflow-hidden flex flex-col">
        <!-- Header -->
        <div class="bg-gradient-to-r from-green-600 to-green-900 text-white pt-8 pb-6 px-8 rounded-t-2xl">
            <div class="flex items-center justify-between">
                <h3 class="text-[1.8rem] font-bold">National Common Mobility Card (Rapid Pass)</h3>
                <button onclick="closeRapidPassModal()" class="text-white hover:text-green-200 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Scrollable Content Container -->
        <div class="flex-1 overflow-y-auto">
            <div class="px-8 py-8">
                <!-- RAPID Pass Image -->
                <div class="text-center mb-8">
                    <img src="RapidPass.jpg" alt="RAPID Pass Card" class="mx-auto max-w-md w-full h-auto rounded-2xl shadow-lg">
                </div>

                <!-- Main Title -->
                <div class="text-center mb-8">
                    <h4 class="text-3xl font-bold text-green-700 mb-3">One Card, All Transports</h4>
                    <p class="text-lg text-gray-600">Experience seamless travel across the entire transport network with Bangladesh's National Common Mobility Card</p>
                </div>

                <!-- Benefits Grid -->
                <div class="mb-10">
                    <!-- Multi-Transport Access - Expanded -->
                    <div class="bg-gradient-to-r from-green-600 to-green-900 rounded-2xl p-8 border border-green-200 max-w-4xl mx-auto">
                        <div class="flex items-center mb-6">
                            <div class="bg-green-500 rounded-full p-4 mr-5">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                </svg>
                            </div>
                            <div>
                                <h5 class="text-[2.0rem] font-bold text-white mb-1">Multi-Transport Access</h5>
                                <p class="text-white text-lg">One card for all your transportation needs across Bangladesh</p>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-3">
                                <h6 class="font-semibold text-white mb-3 text-xl">Primary Transport Systems</h6>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Metro Rail (MRT) - Lines 1-6</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Bus Rapid Transit (BRT)</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">BRTC City Buses</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Ferry Services (Sadarghat-Shimolia)</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Intercity Train Services</span>
                                </div>
                            </div>

                            <div class="space-y-3">
                                <h6 class="font-semibold text-white mb-3 text-xl">Additional Services</h6>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Airport Express Services</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Suburban Rail Networks</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Regional Bus Services</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Parking Facilities at Stations</span>
                                </div>
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-white font-medium">Future Elevated Expressways</span>
                                </div>
                            </div>
                        </div>

                        <!-- Key Benefits Section -->
                        <div class="mt-6 p-4 bg-gray-100 rounded-xl">
                            <h6 class="font-semibold text-green-700 mb-3 flex items-center text-lg">
                                <svg class="w-6 h-6 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Why Choose Multi-Transport Access?
                            </h6>
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-green-700 mb-1">150+</div>
                                    <div class="text-sm text-green-700">Routes Covered</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-green-700 mb-1">24/7</div>
                                    <div class="text-sm text-green-700">Service Availability</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-green-700 mb-1">15%</div>
                                    <div class="text-sm text-green-700">Extra Savings on Transfers</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pricing Information -->
                <div class="bg-gray-50 rounded-2xl p-8 mb-8">
                    <div class="text-center mb-6">
                        <h5 class="text-[2.0rem] font-bold text-gray-800 mb-2">Get Your RAPID Pass Today</h5>
                        <p class="text-gray-600 text-[1.2rem]">Start your seamless journey across Bangladesh's transport network</p>
                    </div>

                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200 max-w-lg mx-auto">
                        <div class="text-center">
                            <div class="text-4xl font-bold text-green-700 mb-2">৳400</div>
                            <div class="text-gray-600 mb-4">
                                <span class="text-lg">৳200 refundable security deposit</span><br>
                                <span class="text-lg">৳200 initial balance</span>
                            </div>
                            <div class="bg-green-700 text-white text-sm px-4 py-3 rounded-lg mb-4">
                                <strong>Save 10% on every trip!</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Registration Download Section -->
                <div class="bg-gradient-to-r from-green-600 to-green-900 rounded-2xl p-8 text-white">
                    <div class="text-center mb-6">
                        <h5 class="text-2xl font-bold mb-2">Ready to Get Started?</h5>
                        <p class="text-white text-lg">Download the registration form and visit your nearest metro station</p>
                    </div>

                    <div class="flex justify-center items-center">
                        <!-- Download Form Button -->
                        <button onclick="downloadForm()" class="inline-flex items-center gap-3 bg-white text-green-700 font-semibold px-8 py-4 rounded-xl hover:bg-green-50 transition-colors shadow-lg">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-4-4m4 4l4-4m-6 8h8a2 2 0 002-2v-8a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                            <span>Download Form</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- PERFECTLY ALIGNED MINIMALISTIC FARE CALCULATOR MODAL -->
<div id="fareCalculatorModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden flex items-center justify-center p-8 backdrop-blur-sm">
    <div class="bg-white rounded-[24px] w-full max-w-2xl max-h-[90vh] shadow-2xl overflow-hidden flex flex-col">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-green-600 to-green-900 text-white pt-8 pb-6 px-8 rounded-t-2xl">
            <div class="flex items-center justify-between">
                <h3 class="text-[1.8rem] font-bold">Fare Calculator</h3>
                <button onclick="closeFareCalculatorModal()" class="text-white hover:text-green-200 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Content with Perfect 32px Padding -->
        <div class="flex-1 overflow-y-auto">
            <div class="px-8 py-8">
                <!-- Title Section - Perfectly Centered -->
                <div class="text-left mb-8">
                    <p class="text-[1.4rem] text-gray-500">Select stations to calculate journey cost</p>
                </div>

                <!-- Station Selection with Perfect Spacing -->
                <div class="space-y-6 mb-4">
                    <!-- From Station -->
                    <div>
                        <div class="flex items-center mb-3">
                            <div class="w-2 h-2 bg-green-700 rounded-full mr-3"></div>
                            <span class="text-[1.2rem] font-semibold text-green-700 uppercase tracking-wide">From</span>
                        </div>
                        <div class="relative">
                            <select id="fromStationPerfect" class="w-full text-[1.1rem] text-gray-900 bg-transparent border-0 border-b border-gray-300 focus:border-gray-900 focus:outline-none pb-2 appearance-none px-2">
                                <option value="">Choose departure station</option>
                                <option value="uttara-north">Uttara North</option>
                                <option value="uttara-center">Uttara Center</option>
                                <option value="uttara-south">Uttara South</option>
                                <option value="pallabi">Pallabi</option>
                                <option value="mirpur-11">Mirpur-11</option>
                                <option value="mirpur-10">Mirpur-10</option>
                                <option value="kazipara">Kazipara</option>
                                <option value="shewrapara">Shewrapara</option>
                                <option value="agargaon">Agargaon</option>
                                <option value="bijoy-sarani">Bijoy Sarani</option>
                                <option value="farmgate">Farmgate</option>
                                <option value="karwan-bazar">Karwan Bazar</option>
                                <option value="shahbagh">Shahbagh</option>
                                <option value="dhaka-university">Dhaka University</option>
                                <option value="secretariat">Secretariat</option>
                                <option value="motijheel">Motijheel</option>
                            </select>
                            <div class="absolute right-0 top-0 h-full flex items-center pointer-events-none">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Swap Button - Perfectly Centered -->
                    <div class="flex justify-center">
                        <button onclick="swapStationsPerfect()" class="w-12 h-12 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition-colors">
                            <svg class="w-5 h-5 text-gray-800 transform hover:rotate-180 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- To Station -->
                    <div>
                        <div class="flex items-center mb-3">
                            <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                            <span class="text-[1.2rem] font-semibold text-red-500 uppercase tracking-wide">To</span>
                        </div>
                        <div class="relative">
                            <select id="toStationPerfect" class="text-[1.1rem] w-full text-gray-900 bg-transparent border-0 border-b border-gray-300 focus:border-gray-900 focus:outline-none pb-2 appearance-none px-2">
                                <option value="">Choose destination station</option>
                                <option value="uttara-north">Uttara North</option>
                                <option value="uttara-center">Uttara Center</option>
                                <option value="uttara-south">Uttara South</option>
                                <option value="pallabi">Pallabi</option>
                                <option value="mirpur-11">Mirpur-11</option>
                                <option value="mirpur-10">Mirpur-10</option>
                                <option value="kazipara">Kazipara</option>
                                <option value="shewrapara">Shewrapara</option>
                                <option value="agargaon">Agargaon</option>
                                <option value="bijoy-sarani">Bijoy Sarani</option>
                                <option value="farmgate">Farmgate</option>
                                <option value="karwan-bazar">Karwan Bazar</option>
                                <option value="shahbagh">Shahbagh</option>
                                <option value="dhaka-university">Dhaka University</option>
                                <option value="secretariat">Secretariat</option>
                                <option value="motijheel">Motijheel</option>
                            </select>
                            <div class="absolute right-0 top-0 h-full flex items-center pointer-events-none">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Area with Perfect Alignment -->
                <div id="resultsAreaPerfect">
                    <!-- Default State -->
                    <div id="defaultStatePerfect" class="text-center pt-5 pb-2">
                        <div class="w-12 h-12 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center">
                            <svg class="w-8 h-8 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                            </svg>
                        </div>
                        <h4 class="text-[1.3rem] font-normal text-gray-900 mb-1">Select your journey</h4>
                        <p class="text-[1.1rem] text-gray-500">Choose stations to see fare comparison</p>
                    </div>

                    <!-- Results State with Perfect Grid -->
                    <div id="resultsStatePerfect" class="hidden">
                        <!-- Journey Info - Perfectly Centered -->
                        <div class="text-center mb-6 py-4 bg-gray-100 rounded-2xl">
                            <div class="text-[1.3rem] font-semibold text-gray-900 mb-1" id="journeyDistancePerfect"></div>
                            <div class="text-[1.1rem] text-gray-600" id="journeyTimePerfect"></div>
                        </div>

                        <!-- Ticket Comparison - Perfect 2-Column Grid -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <!-- Single Journey -->
                            <div class="bg-gray-100 rounded-2xl p-4 text-center">
                                <div class="w-10 h-10 mx-auto mb-3 bg-gray-200 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path>
                                    </svg>
                                </div>
                                <div class="text-sm font-medium text-gray-600 mb-2 uppercase tracking-wide">Single Journey</div>
                                <div class="text-xl font-bold text-gray-900">৳<span id="singleTicketFarePerfect">30</span></div>
                            </div>

                            <!-- MRT Pass -->
                            <div class="bg-green-100 rounded-2xl p-4 text-center border border-green-200">
                                <div class="w-10 h-10 mx-auto mb-3 bg-green-700 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                </div>
                                <div class="text-sm font-medium text-green-800 mb-2 uppercase tracking-wide">MRT Pass</div>
                                <div class="text-xl font-bold text-green-800">৳<span id="mrtPassFarePerfect">27</span></div>
                            </div>
                        </div>

                        <!-- Savings Badge - Perfectly Centered -->
                        <div class="text-center mb-6">
                            <div class="inline-flex items-center px-10 py-2 bg-green-100 rounded-full">
                                <svg class="w-4 h-4 text-green-700 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.7" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                                <span class="text-[1.0rem] font-medium text-green-800">Save ৳<span id="savingsAmountPerfect">3</span> with MRT Pass</span>
                            </div>
                        </div>

                        <!-- Action Button - Full Width -->
                        <button onclick="recalculatePerfect()" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-2xl transition-colors">
                            Recalculate Journey
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- TICKETS MODAL - Keep Original -->
<div id="ticketsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-green-600 to-green-900 text-white pt-8 pb-6 px-8 rounded-t-2xl">
            <div class="flex items-center justify-between">
                <h3 class="text-[1.8rem] font-bold">Metro Ticket Types</h3>
                <button onclick="closeTicketsModal()" class="text-white hover:text-green-200 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Modal Content -->
        <div class="p-8">
            <p class="text-gray-600 mb-8 text-[1.3rem]">Choose from our convenient ticket options for your metro journey.</p>

            <!-- Ticket Types -->
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Single Journey Ticket -->
                <div class="bg-white border-2 border-gray-200 rounded-xl p-6 hover:border-green-500 hover:shadow-lg transition-all duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="bg-green-100 p-3 rounded-full">
                                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800">Single Journey Ticket</h4>
                                <p class="text-gray-600">One-way ticket for immediate travel</p>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 text-center py-4">
                        <div class="text-4xl font-bold text-green-600 mb-2">৳20 - ৳100</div>
                        <div class="text-lg text-gray-600">Based on distance traveled</div>
                    </div>

                    <div class="mb-6">
                        <h5 class="font-semibold text-gray-700 mb-3 flex items-center text-[1.2rem]">
                            <svg class="w-5 h-5 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            Features
                        </h5>
                        <ul class="space-y-2 text-lg">
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Valid for one journey only
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                60-minute time limit
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Available at stations or TVMs
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                No advance booking required
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Discounted rate for Freedom fighters
                            </li>
                        </ul>
                    </div>

                    <div class="text-center text-[1.0rem] text-white bg-green-600 p-3 rounded-lg">
                        Perfect for occasional travelers and tourists
                    </div>
                </div>

                <!-- MRT Pass/RAPID Pass -->
                <div class="bg-white border-2 border-gray-200 rounded-xl p-6 hover:border-green-500 hover:shadow-lg transition-all duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="bg-green-100 p-3 rounded-full">
                                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800">MRT Pass (RAPID Pass)</h4>
                                <p class="text-gray-600">Rechargeable smart card</p>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 text-center py-4">
                        <div class="text-4xl font-bold text-green-600 mb-2">৳400</div>
                        <div class="text-sm text-gray-600">
                            <span class="line-through text-gray-400 text-sm">৳100</span>
                            <span class="ml-2 bg-green-50 text-green-600 px-4 py-1 rounded-full font-semibold">Save 10%</span>
                        </div>
                        <div class="text-[1.1rem] text-gray-500 mt-2">৳200 deposit + ৳200 initial balance</div>
                    </div>

                    <div class="mb-6">
                        <h5 class="font-semibold text-gray-700 mb-3 flex items-center text-[1.2rem]">
                            <svg class="w-5 h-5 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            Features
                        </h5>
                        <ul class="space-y-2 text-lg">
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                10% discount on every trip
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                10 years validity
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Contactless NFC technology
                            </li>
                            <li class="flex items-start text-gray-600">
                                <svg class="w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-1 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Easy top-up (৳100-৳10,000)
                            </li>
                        </ul>
                    </div>

                    <div class="text-center text-[1.0rem] text-white bg-green-600 p-3 rounded-lg">
                        Ideal for regular commuters and frequent travelers
                    </div>
                </div>
            </div>

            <!-- Information Notice -->
            <div class="mt-8 p-6 bg-gradient-to-r from-green-600 to-green-900 rounded-xl border border-green-200">
                <div class="flex items-start space-x-3">
                    <svg class="w-6 h-6 text-green-100 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <h6 class="text-lg font-semibold text-white mb-1">Information Only</h6>
                        <p class="text-white text-[1.0rem]">
                            This is for information purposes only. To purchase tickets, please visit any metro station or use the Ticket Vending Machines (TVMs) available at all stations.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script>
    (function() {
        const wrapper = document.getElementById('map-wrapper');
        const img = document.getElementById('metro-map');
        const overlay = document.getElementById('map-overlay');
        const indicator = document.getElementById('zoom-indicator');
        const btnIn = document.getElementById('zoom-in');
        const btnOut = document.getElementById('zoom-out');
        const btnReset = document.getElementById('zoom-reset');

        const clamp = (n, min, max) => Math.min(max, Math.max(min, n));

        let scale = 1, min = 1, max = 4;
        let tx = 0, ty = 0;
        let dragging = false, sx = 0, sy = 0;

        function apply() {
            img.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
            indicator.textContent = Math.round(scale * 100) + '%';
        }

        function bound() {
            const rect = wrapper.getBoundingClientRect();
            const w = rect.width, h = rect.height;
            const minTx = w - w * scale;
            const minTy = h - h * scale;
            tx = clamp(tx, minTx, 0);
            ty = clamp(ty, minTy, 0);
        }

        function zoomAt(clientX, clientY, factor) {
            const rect = wrapper.getBoundingClientRect();
            const x = clientX - rect.left - tx;
            const y = clientY - rect.top - ty;
            const newScale = clamp(scale * factor, min, max);
            tx = clientX - rect.left - x * (newScale / scale);
            ty = clientY - rect.top - y * (newScale / scale);
            scale = newScale;
            bound();
            apply();
        }

        overlay.addEventListener('wheel', (e) => {
            e.preventDefault();
            const factor = e.deltaY < 0 ? 1.12 : 0.9;
            zoomAt(e.clientX, e.clientY, factor);
        }, { passive: false });

        overlay.addEventListener('pointerdown', (e) => {
            dragging = true;
            sx = e.clientX;
            sy = e.clientY;
            overlay.setPointerCapture(e.pointerId);
        });

        overlay.addEventListener('pointermove', (e) => {
            if (!dragging) return;
            tx += e.clientX - sx;
            ty += e.clientY - sy;
            sx = e.clientX;
            sy = e.clientY;
            bound();
            apply();
        });

        function endDrag(e) {
            dragging = false;
            try {
                overlay.releasePointerCapture(e.pointerId);
            } catch {}
        }

        overlay.addEventListener('pointerup', endDrag);
        overlay.addEventListener('pointercancel', endDrag);

        overlay.tabIndex = 0;

        btnIn.addEventListener('click', () => {
            const r = wrapper.getBoundingClientRect();
            zoomAt(r.left + r.width / 2, r.top + r.height / 2, 1.2);
        });

        btnOut.addEventListener('click', () => {
            const r = wrapper.getBoundingClientRect();
            zoomAt(r.left + r.width / 2, r.top + r.height / 2, 0.83);
        });

        btnReset.addEventListener('click', () => {
            scale = 1;
            tx = 0;
            ty = 0;
            apply();
        });

        overlay.addEventListener('keydown', (e) => {
            if (e.key === '+' || e.key === '=') btnIn.click();
            if (e.key === '-' || e.key === '_') btnOut.click();
            if (e.key === '0') btnReset.click();
        });

        apply();
    })();
</script>

<script>
    const stations = {
        'uttara-north': { name: 'Uttara North', position: 0 },
        'uttara-center': { name: 'Uttara Center', position: 1 },
        'uttara-south': { name: 'Uttara South', position: 2 },
        'pallabi': { name: 'Pallabi', position: 3 },
        'mirpur-11': { name: 'Mirpur-11', position: 4 },
        'mirpur-10': { name: 'Mirpur-10', position: 5 },
        'kazipara': { name: 'Kazipara', position: 6 },
        'shewrapara': { name: 'Shewrapara', position: 7 },
        'agargaon': { name: 'Agargaon', position: 8 },
        'bijoy-sarani': { name: 'Bijoy Sarani', position: 9 },
        'farmgate': { name: 'Farmgate', position: 10 },
        'karwan-bazar': { name: 'Karwan Bazar', position: 11 },
        'shahbagh': { name: 'Shahbagh', position: 12 },
        'dhaka-university': { name: 'Dhaka University', position: 13 },
        'secretariat': { name: 'Secretariat', position: 14 },
        'motijheel': { name: 'Motijheel', position: 15 }
    };

    // RAPID Pass Modal Functions
    function showRapidPassModal() {
        document.getElementById('rapidPassModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeRapidPassModal() {
        document.getElementById('rapidPassModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
    }

    // Fare Calculator Modal Functions
    function showFareCalculatorModal() {
        document.getElementById('fareCalculatorModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        resetPerfectModal();
        document.getElementById('fromStationPerfect').addEventListener('change', autoCalculatePerfect);
        document.getElementById('toStationPerfect').addEventListener('change', autoCalculatePerfect);
    }

    function closeFareCalculatorModal() {
        document.getElementById('fareCalculatorModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
        resetPerfectModal();
    }

    function resetPerfectModal() {
        document.getElementById('defaultStatePerfect').classList.remove('hidden');
        document.getElementById('resultsStatePerfect').classList.add('hidden');
        document.getElementById('fromStationPerfect').value = '';
        document.getElementById('toStationPerfect').value = '';
    }

    function swapStationsPerfect() {
        const fromStation = document.getElementById('fromStationPerfect');
        const toStation = document.getElementById('toStationPerfect');
        const tempValue = fromStation.value;
        fromStation.value = toStation.value;
        toStation.value = tempValue;
        if (fromStation.value && toStation.value) {
            autoCalculatePerfect();
        }
    }

    function autoCalculatePerfect() {
        const fromStation = document.getElementById('fromStationPerfect').value;
        const toStation = document.getElementById('toStationPerfect').value;

        if (!fromStation || !toStation || fromStation === toStation) {
            document.getElementById('defaultStatePerfect').classList.remove('hidden');
            document.getElementById('resultsStatePerfect').classList.add('hidden');
            return;
        }

        calculatePerfectFare();
    }

    function calculatePerfectFare() {
        const fromStation = document.getElementById('fromStationPerfect').value;
        const toStation = document.getElementById('toStationPerfect').value;
        const fromPos = stations[fromStation].position;
        const toPos = stations[toStation].position;
        const stationCount = Math.abs(toPos - fromPos);
        const travelTime = Math.round(stationCount * 2.5);

        const baseFare = 20;
        const farePerStation = 5;
        const additionalStations = Math.max(0, stationCount - 1);
        const additionalFare = additionalStations * farePerStation;
        const singleTicketFare = baseFare + additionalFare;
        const mrtPassFare = Math.round(singleTicketFare * 0.9);
        const savings = singleTicketFare - mrtPassFare;

        document.getElementById('journeyDistancePerfect').textContent = `${stationCount} stations`;
        document.getElementById('journeyTimePerfect').textContent = `${travelTime} minutes`;
        document.getElementById('singleTicketFarePerfect').textContent = singleTicketFare;
        document.getElementById('mrtPassFarePerfect').textContent = mrtPassFare;
        document.getElementById('savingsAmountPerfect').textContent = savings;

        document.getElementById('defaultStatePerfect').classList.add('hidden');
        document.getElementById('resultsStatePerfect').classList.remove('hidden');
    }

    function recalculatePerfect() {
        autoCalculatePerfect();
    }
    function downloadForm() {
            try {
                // Method 1: Try direct wwwroot path
                const link = document.createElement('a');
                link.href = '/RAPID_Registration_Form.pdf';
                link.download = 'RAPID_Pass_Registration_Form.pdf';
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Show success message
                // setTimeout(() => {
                //     alert('Form download started! If download doesn\'t start automatically, please check your browser\'s download folder or visit any Metro station to get the form.');
                // }, 1000);

            } catch (error) {
                console.error('PDF download failed:', error);
                // Fallback: Try alternative paths
                downloadFormFallback();
            }
        }
    // Tickets Modal Functions
    function showTicketsModal() {
        document.getElementById('ticketsModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeTicketsModal() {
        document.getElementById('ticketsModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
    }

    // Close modals when clicking outside
    document.getElementById('rapidPassModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeRapidPassModal();
        }
    });

    document.getElementById('fareCalculatorModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeFareCalculatorModal();
        }
    });

    document.getElementById('ticketsModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeTicketsModal();
        }
    });

    // Close modals with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeRapidPassModal();
            closeFareCalculatorModal();
            closeTicketsModal();
        }
    });
</script>
